% Thesis/Dissertation LaTeX Template
% Formal university format with comprehensive front matter
% Designed for PhD dissertations and master's theses

\documentclass[12pt, a4paper, onecolumn, openright]{report}

% Essential packages
\usepackage[left=1.5in, right=1in, top=1in, bottom=1in]{geometry}
\usepackage{fontspec}
\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{physics}

% Add graphics path to help find figure files
\graphicspath{{./figures/}{../figures/}}

% Color packages
\usepackage{xcolor}
\usepackage{tcolorbox}

% University color scheme (formal, traditional)
\definecolor{universityblue}{RGB}{0, 49, 109}
\definecolor{universitygold}{RGB}{255, 199, 44}
\definecolor{darkgray}{RGB}{64, 64, 64}
\definecolor{lightgray}{RGB}{245, 245, 245}
\definecolor{shadecolor}{rgb}{0.97,0.97,0.97}

% Table and figure packages
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{float}
\usepackage{rotating}
\usepackage{pdflscape}

% Code highlighting packages
\usepackage{fancyvrb}
\usepackage{framed}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newenvironment{Highlighting}{\begin{Shaded}}{\end{Shaded}}

% Define syntax highlighting commands
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}

% Font settings - traditional thesis fonts
\setmainfont{Times New Roman}[
  BoldFont = Times New Roman Bold,
  ItalicFont = Times New Roman Italic,
  BoldItalicFont = Times New Roman Bold Italic,
]
\setsansfont{Arial}
\setmonofont{Courier New}

% Double spacing required for theses
\usepackage{setspace}
\doublespacing

% Page numbering styles
\usepackage{fancyhdr}

% Roman numerals for front matter, arabic for main content
\newcommand{\frontmatter}{
  \pagenumbering{roman}
  \pagestyle{plain}
}

\newcommand{\mainmatter}{
  \newpage
  \pagenumbering{arabic}
  \pagestyle{fancy}
  \fancyhf{}
  \fancyhead[R]{\thepage}
  \renewcommand{\headrulewidth}{0pt}
}

% Chapter and section formatting
\usepackage{titlesec}

% Chapter formatting
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries\centering}
  {\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter}{0pt}{50pt}{40pt}

% Section formatting
\titleformat{\section}
  {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}

% Hyperlinks
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=universityblue,
    filecolor=universityblue,
    urlcolor=universityblue,
    citecolor=universityblue,
    pdfauthor={$author$},
    pdftitle={$title$},
    pdfpagemode={UseOutlines},
    bookmarksopen=true,
    pdfstartview={FitH}
}

% Bibliography - formal academic style
\usepackage[backend=biber, style=apa, citestyle=apa]{biblatex}

% Define missing commands
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\providecommand{\pandocbounded}[1]{\csname pandocbounded#1\endcsname}

% Table of contents customization
\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill}

% List of figures and tables
\renewcommand{\cftloftitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftafterloftitle}{\hfill}
\renewcommand{\cftlottitlefont}{\hfill\Large\bfseries}
\renewcommand{\cftafterlottitle}{\hfill}

% Caption styling
\usepackage[font=small,
            labelfont=bf,
            labelsep=period,
            justification=justified]{caption}



% Title page
\renewcommand{\maketitle}{
  \begin{titlepage}
    \begin{center}
      \vspace*{1in}
      
      {\Large\textbf{$title$}}
      
      \vspace{1in}
      
      {A Dissertation}\\
      {Presented to}\\
      {The Faculty of the Graduate School}\\
      {University Name}
      
      \vspace{1in}
      
      {In Partial Fulfillment}\\
      {of the Requirements for the Degree}\\
      {Doctor of Philosophy}
      
      \vspace{1in}
      
      {by}\\
      \vspace{0.5in}
      {\textbf{$author$}}
      
      \vspace{1in}
      
      {$date$}
      
    \end{center}
  \end{titlepage}
}

% Abstract environment for thesis
\renewenvironment{abstract}{
  \chapter*{Abstract}
  \addcontentsline{toc}{chapter}{Abstract}
}{
  \newpage
}

% Acknowledgments environment
\newenvironment{acknowledgments}{
  \chapter*{Acknowledgments}
  \addcontentsline{toc}{chapter}{Acknowledgments}
}{
  \newpage
}

% Dedication environment
\newenvironment{dedication}{
  \chapter*{}
  \vspace*{2in}
  \begin{center}
    \textit{
}{
    }
  \end{center}
  \newpage
}

% Committee approval page
\newcommand{\approvalpage}{
  \begin{titlepage}
    \begin{center}
      \vspace*{1in}
      
      {\Large\textbf{$title$}}
      
      \vspace{1in}
      
      {by}\\
      \vspace{0.5in}
      {\textbf{$author$}}
      
      \vspace{1in}
      
      {Approved by:}
      
      \vspace{1in}
      
      \begin{tabular}{p{3in}p{2in}}
        \rule{3in}{0.5pt} & Date: \rule{1.5in}{0.5pt} \\
        \@advisor, Chair & \\
        & \\
        \ifx\@coadvisor\empty\else
        \rule{3in}{0.5pt} & Date: \rule{1.5in}{0.5pt} \\
        \@coadvisor, Co-advisor & \\
        & \\
        \fi
        \rule{3in}{0.5pt} & Date: \rule{1.5in}{0.5pt} \\
        Committee Member & \\
        & \\
        \rule{3in}{0.5pt} & Date: \rule{1.5in}{0.5pt} \\
        Committee Member & \\
      \end{tabular}
      
    \end{center}
  \end{titlepage}
}

% Begin document
\begin{document}

% Front matter
\frontmatter

% Title page
\maketitle

% Abstract
$if(abstract)$
\begin{abstract}
$abstract$
\end{abstract}
$endif$

% Table of contents
\tableofcontents

% List of figures
\listoffigures

% List of tables  
\listoftables

% Main matter
\mainmatter

% Main document content
$body$

% References
$if(bibliography)$
\printbibliography[title=References]
\addcontentsline{toc}{chapter}{References}
$endif$

\end{document}
